{"title":"Piece-wise polynomials","markdown":{"yaml":{"title":"Piece-wise polynomials","subtitle":"On the rationale behind and the explicit/implicit forms of piece-wise polynomial residuals and their potential use."},"headingText":"Why?","containsRefs":false,"markdown":"\n\n***\n\nIn this section, we discuss the class of piece-wise polynomial relationship, in their implicit and explicit forms. \n\nBut let us first justify the reason for which these relationships might be of great help in characterizing the normality in industrial time-series and hence in detecting unmodelled anomalies in industrial equipments. \n\n\nAlthough multi-variate polynomials relationhips cover a wide class of physical laws, it is obvious that they do not cover every possibility. Think about the relationship involving trigonometric functions, square roots, exponential or rational relationships[^ifknown]. \n\nHowever, any smooth relationship can be represented by **region-dependent** polynomials, namely: \n\n:::{.callout-note title='Piece-wise polynomials'}\n the feature space is *partitioned* into a set of regions over each of which a polynomial relationship captures the dependencies that hold on that specific region.  \n:::\n\nIn the industrial context, the regions mentioned above can be the result of **different contexts** of use that might encompass different tunings of controller, different values of the set-points or different configurations of the system. \n\n## Examples \n\nOne can simply think about a controlled system that tracks some reference signal $\\texttt{y\\_ref}$ and depending on the error $e=y-\\texttt{y\\_ref}$ between the regulated signal $y$ and that reference $\\texttt{y\\_ref}$. In order to avoid overshoots, it is common to define a **gain scheduled** feedback which applies a control voltage, say $u$ which is propotional to the error with a proportional gain $K$ that is: \n\n- High when small tracking errors are measured and \n- Low when high tracking errors are measured. \n\nNamely \n\n$$\nu = \\left\\{\n\\begin{array}{ll}\n-K_h\\times e\\quad & \\text{if $\\vert e\\vert \\le \\epsilon$}\\\\\n-K_\\ell\\times e\\quad & \\text{otherwise}\\\\\n\\end{array}\n\\right.\n$${#eq-conditionalgain}\n\nThis obviously splits the space (via the condition $\\vert y-\\texttt{y\\_{ref}}\\vert\\le \\epsilon$) into two regions over each of which the relationship between the features $(y,\\texttt{y\\_ref})$ and the targeted label $u$ is polynomial (linear in the specific example) but there is no a single polynomial relationship that matches the relationship @eq-conditionalgain on the whole space of features. \n\nThis example is quite simple compared to industrial context where so many parameters might be involved in the definition of the so-called context. The latter is rarely available to the engineer in charge of designing anomaly detection algorithms. This means that: \n\n:::{.callout-warning title='Blind handling of context'}\nThe normality characterization algorithm should be unaware of the parameters that defines the context (the different regions of smooth relationships). The piece-wise relationships should be built **without the knowlege** of the precise definition of the unknown region. \n:::\n\n::: {.columns}\n\n::: {.column width=65%}\nThe figure aside shows another examples that comes from the [Kaggle dataset](https://www.kaggle.com/datasets/mazenalamir/parametric-anomaly-detection-in-time-series) dedicated to the parameteric anomaly detection in time-series. \n\nOver each of the four regions, a sensor $y$ depends on the features vector $x\\in \\mathbb R^2$ through different polynomials, namely:\n\n$$\ny = P_i(x)\\quad x\\in \\mathcal R_i\\quad i\\in \\{1,\\dots,4\\}\n$${#eq-explicit}\n:::\n\n::: {.column width=5%}\n \n:::\n\n::: {.column width=30%}\n![](images/pwregions.png)\n:::\n\n:::\n\n## Explicit form\n\nWhen the region is known, namely when it is possible, knowing $x$ to associate the index $i$ of the region as shown in @eq-explicit, the relationship is called **explicit piewe-wise polynomial**. \n\nMore precisely, in the case of explicit piece-wise relationships, there exists a known integer values map $i^\\star$ such that for a given $x$, $i^\\star(x)$ denotes the index of the region to which belong the features vector $x$:\n\n$$\nx\\in \\mathcal R_{i^\\star(x)}\n$${#eq-indexmap}\n\nIn this case, the relationship @eq-explicit enables to *predict* the value of the label $y$ for a given value of the features vector $x$. The normality is then associated to the so-called **prediction error** given by: \n\n$$\ne = \\mu\\Bigl(\\overbrace{P_{i^\\star(x)}(x)}^{\\hat y(x)}-y\\Bigr)\n$${#eq-explicit-error}\n\nThe `xpwpol` module of the `MizoPol` package enables to derive this kind of explicit relationships in some parituclar use-cases. More details in the  [`xpwpol` module' section](xpwpol_intro.qmd) and the sections that follow it where some examples are given.\n\nAlthough the explicit piece-wise polynomial form is even larger than the explicit single unique polynomial form, it is sometimes hard to find for the reasons invoked in the following section. \n\n### The need for an implicit form\n\nUnfortunately, as it has been mentioned earlier, it is not always possible to identify the region's index map @eq-indexmap in real-life situations. There are two reasons for this impossibility:\n\n1. The first lies in the difficulties associated to the identification of the classifier represented by the index region map $i^\\star(x)$ even when it factually exists. \n\n2. More importantly, it is possible that there is no explicit relationship between the feature vector $x$ and the label $y$ because the information contained in $x$ is not complete. \n\n    This is the case for instance when the true *hidden* relationship that governs $y$ takes the following form: \n\n    $$\n    y = F(x, z)\\quad  \\text{$z$ not available}\n    $$\n\n    where $z$ is a context variable having a finite set of unknown values that do not depend on the vector $x$ of features[^context]. Obviously, since in this case, the context does not depend on the features, it is impossible to identify the index map from the sole knowledge of $x$ as $z$ which is a crucial information that is needed to define the region, is simply not available. \n\nHere is where the implicit form of the piece-wise relationships enter into the scene. This is explained in the next section. \n\n## Implicit form \n\nIn the implicit form of the normality characterization via piece-wise polynomial relationships, the residual is defined by the following equality:\n\n$$\ne = \\min_{i=1}^{n_r} \\left\\vert y - P_i(x)\\right\\vert \n$${#eq-implicit-pwpol}\n\nwhere $n_r$ is the number of multi-variate polynomials that are involved in the implicit relationship. \n\nIt is important to notice that:\n\n::: {.callout-warning title='No predicted value of $y$'}\nThe relationship @eq-implicit-pwpol that determines the residual $e$ expresses the distance of the measurement $y$ to the closest value among the set of values provided by the set of polynomials at $x$, namely: \n\n$$\\Bigl\\{\\hat y_i(x):=P_i(x)\\Bigr\\}_{i\\le n_r}$$ \n\nThere is no way to compute the predicted value of $y$ (by the model) before the true value of $y$ is known. \n\nIn other words, in the absence of $y$, there is no way to determine which one of the values $P_i(x)$ is the closest to the true value $y$.\n:::\n\nThis is why the implicit relationships are mainly used to characterize the normality and hence to **raise alarms** when the residual goes beyond some pre-defined threshold. \n\nThe explicit form might be used for both anomalies detection and digital twin enhancement. But the latter is less common to be found. \n\n## All the identification are parsimonious\n\nIn the above discussion, we did not recall the fact that:\n\n:::{.callout-note title='All raltionships are parsimoniously identified'}\n whether they are implicit or explicit, the polynomial relationships that are identified by the modules of the MizoPol suite are all **parsimonious**.\n:::\n\n The reasons for which parsimony is a key element in the context of processing industrial and technological time-series are discussed in the next section. \n\n \n\n[^ifknown]: Notice however that if these non polynomial maps are a priori known, a virtual components might be added to the vector of features $x$ so that the standard polynomial structure become appropriate to capture the originally non polynomial relationships. But we do not consider this case here. \n\n[^context]: Think about a robot performing a set of different tasks involving pieces of different weights and/or moments of ineria.\n\n\n\n","srcMarkdownNoYaml":"\n\n***\n\nIn this section, we discuss the class of piece-wise polynomial relationship, in their implicit and explicit forms. \n\nBut let us first justify the reason for which these relationships might be of great help in characterizing the normality in industrial time-series and hence in detecting unmodelled anomalies in industrial equipments. \n\n## Why?\n\nAlthough multi-variate polynomials relationhips cover a wide class of physical laws, it is obvious that they do not cover every possibility. Think about the relationship involving trigonometric functions, square roots, exponential or rational relationships[^ifknown]. \n\nHowever, any smooth relationship can be represented by **region-dependent** polynomials, namely: \n\n:::{.callout-note title='Piece-wise polynomials'}\n the feature space is *partitioned* into a set of regions over each of which a polynomial relationship captures the dependencies that hold on that specific region.  \n:::\n\nIn the industrial context, the regions mentioned above can be the result of **different contexts** of use that might encompass different tunings of controller, different values of the set-points or different configurations of the system. \n\n## Examples \n\nOne can simply think about a controlled system that tracks some reference signal $\\texttt{y\\_ref}$ and depending on the error $e=y-\\texttt{y\\_ref}$ between the regulated signal $y$ and that reference $\\texttt{y\\_ref}$. In order to avoid overshoots, it is common to define a **gain scheduled** feedback which applies a control voltage, say $u$ which is propotional to the error with a proportional gain $K$ that is: \n\n- High when small tracking errors are measured and \n- Low when high tracking errors are measured. \n\nNamely \n\n$$\nu = \\left\\{\n\\begin{array}{ll}\n-K_h\\times e\\quad & \\text{if $\\vert e\\vert \\le \\epsilon$}\\\\\n-K_\\ell\\times e\\quad & \\text{otherwise}\\\\\n\\end{array}\n\\right.\n$${#eq-conditionalgain}\n\nThis obviously splits the space (via the condition $\\vert y-\\texttt{y\\_{ref}}\\vert\\le \\epsilon$) into two regions over each of which the relationship between the features $(y,\\texttt{y\\_ref})$ and the targeted label $u$ is polynomial (linear in the specific example) but there is no a single polynomial relationship that matches the relationship @eq-conditionalgain on the whole space of features. \n\nThis example is quite simple compared to industrial context where so many parameters might be involved in the definition of the so-called context. The latter is rarely available to the engineer in charge of designing anomaly detection algorithms. This means that: \n\n:::{.callout-warning title='Blind handling of context'}\nThe normality characterization algorithm should be unaware of the parameters that defines the context (the different regions of smooth relationships). The piece-wise relationships should be built **without the knowlege** of the precise definition of the unknown region. \n:::\n\n::: {.columns}\n\n::: {.column width=65%}\nThe figure aside shows another examples that comes from the [Kaggle dataset](https://www.kaggle.com/datasets/mazenalamir/parametric-anomaly-detection-in-time-series) dedicated to the parameteric anomaly detection in time-series. \n\nOver each of the four regions, a sensor $y$ depends on the features vector $x\\in \\mathbb R^2$ through different polynomials, namely:\n\n$$\ny = P_i(x)\\quad x\\in \\mathcal R_i\\quad i\\in \\{1,\\dots,4\\}\n$${#eq-explicit}\n:::\n\n::: {.column width=5%}\n \n:::\n\n::: {.column width=30%}\n![](images/pwregions.png)\n:::\n\n:::\n\n## Explicit form\n\nWhen the region is known, namely when it is possible, knowing $x$ to associate the index $i$ of the region as shown in @eq-explicit, the relationship is called **explicit piewe-wise polynomial**. \n\nMore precisely, in the case of explicit piece-wise relationships, there exists a known integer values map $i^\\star$ such that for a given $x$, $i^\\star(x)$ denotes the index of the region to which belong the features vector $x$:\n\n$$\nx\\in \\mathcal R_{i^\\star(x)}\n$${#eq-indexmap}\n\nIn this case, the relationship @eq-explicit enables to *predict* the value of the label $y$ for a given value of the features vector $x$. The normality is then associated to the so-called **prediction error** given by: \n\n$$\ne = \\mu\\Bigl(\\overbrace{P_{i^\\star(x)}(x)}^{\\hat y(x)}-y\\Bigr)\n$${#eq-explicit-error}\n\nThe `xpwpol` module of the `MizoPol` package enables to derive this kind of explicit relationships in some parituclar use-cases. More details in the  [`xpwpol` module' section](xpwpol_intro.qmd) and the sections that follow it where some examples are given.\n\nAlthough the explicit piece-wise polynomial form is even larger than the explicit single unique polynomial form, it is sometimes hard to find for the reasons invoked in the following section. \n\n### The need for an implicit form\n\nUnfortunately, as it has been mentioned earlier, it is not always possible to identify the region's index map @eq-indexmap in real-life situations. There are two reasons for this impossibility:\n\n1. The first lies in the difficulties associated to the identification of the classifier represented by the index region map $i^\\star(x)$ even when it factually exists. \n\n2. More importantly, it is possible that there is no explicit relationship between the feature vector $x$ and the label $y$ because the information contained in $x$ is not complete. \n\n    This is the case for instance when the true *hidden* relationship that governs $y$ takes the following form: \n\n    $$\n    y = F(x, z)\\quad  \\text{$z$ not available}\n    $$\n\n    where $z$ is a context variable having a finite set of unknown values that do not depend on the vector $x$ of features[^context]. Obviously, since in this case, the context does not depend on the features, it is impossible to identify the index map from the sole knowledge of $x$ as $z$ which is a crucial information that is needed to define the region, is simply not available. \n\nHere is where the implicit form of the piece-wise relationships enter into the scene. This is explained in the next section. \n\n## Implicit form \n\nIn the implicit form of the normality characterization via piece-wise polynomial relationships, the residual is defined by the following equality:\n\n$$\ne = \\min_{i=1}^{n_r} \\left\\vert y - P_i(x)\\right\\vert \n$${#eq-implicit-pwpol}\n\nwhere $n_r$ is the number of multi-variate polynomials that are involved in the implicit relationship. \n\nIt is important to notice that:\n\n::: {.callout-warning title='No predicted value of $y$'}\nThe relationship @eq-implicit-pwpol that determines the residual $e$ expresses the distance of the measurement $y$ to the closest value among the set of values provided by the set of polynomials at $x$, namely: \n\n$$\\Bigl\\{\\hat y_i(x):=P_i(x)\\Bigr\\}_{i\\le n_r}$$ \n\nThere is no way to compute the predicted value of $y$ (by the model) before the true value of $y$ is known. \n\nIn other words, in the absence of $y$, there is no way to determine which one of the values $P_i(x)$ is the closest to the true value $y$.\n:::\n\nThis is why the implicit relationships are mainly used to characterize the normality and hence to **raise alarms** when the residual goes beyond some pre-defined threshold. \n\nThe explicit form might be used for both anomalies detection and digital twin enhancement. But the latter is less common to be found. \n\n## All the identification are parsimonious\n\nIn the above discussion, we did not recall the fact that:\n\n:::{.callout-note title='All raltionships are parsimoniously identified'}\n whether they are implicit or explicit, the polynomial relationships that are identified by the modules of the MizoPol suite are all **parsimonious**.\n:::\n\n The reasons for which parsimony is a key element in the context of processing industrial and technological time-series are discussed in the next section. \n\n \n\n[^ifknown]: Notice however that if these non polynomial maps are a priori known, a virtual components might be added to the vector of features $x$ so that the standard polynomial structure become appropriate to capture the originally non polynomial relationships. But we do not consider this case here. \n\n[^context]: Think about a robot performing a set of different tasks involving pieces of different weights and/or moments of ineria.\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","number-sections":true,"html-math-method":"mathjax","css":["styles/styles.css"],"toc":true,"output-file":"pwpolynomials.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.32","bibliography":["biblio.bib"],"resources":["images/sparsity_osc_*.png","images/anomalies_detection_pbstat_*.png","images/sources_of_anomalies_*.png","images/zema_*.png"],"theme":"flatly","link-citations":true,"csl":"styles/apa.csl","title":"Piece-wise polynomials","subtitle":"On the rationale behind and the explicit/implicit forms of piece-wise polynomial residuals and their potential use."},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}